import{w as P,h as d,o as e,A as vs,q as Ns,K as p,y as ks,X as ne,z as st,U as ps,N as tt,O as at,L as ue,t as rt,V as lt}from"./index-CyL_LHZD.js";import{b as E}from"./blog-DMsYJa6l.js";import{U as dt,u as ie,v as $}from"./user-Gd5V0E3B.js";import{N as it,C as nt,S as ot,P as ge}from"./SafeContentRenderer--cWKUKYB.js";import{C as ws}from"./circle-alert-tVMIzw9b.js";import{L as De}from"./lock-o7I7Bcke.js";import{S as Me}from"./save-DIdJ9itm.js";import{E as ct}from"./eye-off-CQSteKX1.js";import{E as Ps}from"./eye-DA61-mgw.js";import{T as bs}from"./triangle-alert-CblqwdZY.js";import{H as xt}from"./heart-B92sfeiR.js";import{S as ze}from"./shield-qFqMu8fT.js";import{A as us}from"./arrow-left-19gUAP-D.js";import{C as Ee}from"./clock-DIxKepl2.js";import{T as gs}from"./trash-2-CBYYz6iO.js";import{C as O}from"./circle-check-big-C_OMDEs_.js";import{U as mt}from"./upload-G0GTaFPn.js";import{C as Le}from"./check-CkhHwQ0U.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],fs=P("badge-check",ht);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],bt=P("camera",pt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],js=P("cpu",ut);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],ft=P("file-check",gt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yt=P("file-exclamation-point",jt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Re=P("file-text",vt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],kt=P("hash",Nt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ys=P("map-pin",wt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ct=P("phone",Pt);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],At=P("power",It);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],St=P("shield-check",_t),V="https://api.quader864.ir/api/expert/admin",T=()=>({"Content-Type":"application/json",Accept:"application/json"}),F=async t=>{const n=t.headers.get("content-type");if(n&&n.includes("application/json")){const h=await t.json();if(!t.ok)throw new Error(h.message||`API Error: ${t.status}`);return h}else{const h=await t.text();throw console.error(`Non-JSON response from ${t.url}:`,h.substring(0,100)),new Error(`API Error: ${t.status} (Invalid Response Format)`)}},J={addUser:async t=>{try{const n=await fetch(`${V}/add-user`,{method:"POST",headers:T(),mode:"cors",credentials:"include",body:JSON.stringify(t)});return await F(n)}catch(n){throw n}},removeUser:async(t,n)=>{try{const h=await fetch(`${V}/remove-user`,{method:"POST",headers:T(),mode:"cors",credentials:"include",body:JSON.stringify({userEmail:t,expertId:n})});return await F(h)}catch(h){throw h}},updateUser:async(t,n,h)=>{try{const b=await fetch(`${V}/update-user`,{method:"POST",headers:T(),mode:"cors",credentials:"include",body:JSON.stringify({userEmail:t,expertId:n,updates:h})});return await F(b)}catch(b){throw b}},getUsers:async t=>{try{const n=new URLSearchParams;t!=null&&t.expertId&&n.append("expertId",t.expertId),t!=null&&t.licenseType&&n.append("licenseType",t.licenseType),(t==null?void 0:t.isActive)!==void 0&&n.append("isActive",String(t.isActive));const h=await fetch(`${V}/users?${n.toString()}`,{method:"GET",headers:T(),mode:"cors",credentials:"include"});return await F(h)}catch(n){throw console.error("Fetch expert users failed:",n),n}},getUserDetails:async t=>{try{const n=await fetch(`${V}/user/${encodeURIComponent(t)}`,{method:"GET",headers:T(),mode:"cors",credentials:"include"});return await F(n)}catch(n){throw n}},toggleAccess:async(t,n,h)=>{try{const b=await fetch(`${V}/toggle-access`,{method:"POST",headers:T(),mode:"cors",credentials:"include",body:JSON.stringify({userEmail:t,expertId:n,isActive:h})});return await F(b)}catch(b){throw b}},getStats:async t=>{try{const n=new URLSearchParams;t&&n.append("expertId",t);const h=await fetch(`${V}/usage-stats?${n.toString()}`,{method:"GET",headers:T(),mode:"cors",credentials:"include"});return await F(h)}catch(n){throw n}}},Ue=({isOpen:t,onClose:n,onConfirm:h,isProcessing:b=!1})=>{const[j,m]=d.useState("");return t?e.jsx(vs,{children:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:b?void 0:n}),e.jsxs(Ns.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl p-6 max-w-sm w-full border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full",children:e.jsx(ws,{size:24})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Reject Post"})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-4 text-sm",children:"Please provide a reason for rejection. This will be visible to the author."}),e.jsx("textarea",{value:j,onChange:C=>m(C.target.value),disabled:b,className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-slate-900 dark:text-white mb-6 resize-none disabled:opacity-50",rows:3,placeholder:"Reason for rejection..."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:n,disabled:b,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:()=>h(j),disabled:!j.trim()||b,className:"px-6 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg font-medium transition-colors shadow-lg shadow-red-600/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?e.jsx(p,{size:18,className:"animate-spin"}):"Reject Post"})]})]})]})}):null},$e=({label:t,value:n,onChange:h,show:b,toggleShow:j})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:t}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(De,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{type:b?"text":"password",value:n,onChange:h,className:"block w-full pl-10 pr-10 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-accent-500 focus:border-accent-500 dark:text-white text-slate-900 transition-colors",placeholder:"••••••••"}),e.jsx("button",{type:"button",onClick:j,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 dark:hover:text-slate-200",children:b?e.jsx(ct,{className:"h-5 w-5"}):e.jsx(Ps,{className:"h-5 w-5"})})]})]}),zt=({isOpen:t,onClose:n,onSuccess:h})=>{const{changePassword:b}=ks(),[j,m]=d.useState(""),[C,G]=d.useState(""),[q,oe]=d.useState(""),[Y,ce]=d.useState(!1),[M,fe]=d.useState(!1),[K,Oe]=d.useState(!1),[Q,_]=d.useState(""),[W,X]=d.useState(!1);if(!t)return null;const Z=async N=>{if(N.preventDefault(),_(""),console.log("[ChangePassword] Submitting form..."),C.length<8){_("New password must be at least 8 characters long.");return}if(C!==q){_("New passwords do not match.");return}if(j===C){_("New password must be different from current password.");return}X(!0);try{console.log("[ChangePassword] Calling changePassword API...");const S=await b(j,C);console.log("[ChangePassword] API Result:",S),X(!1),S.success?(h(),n(),m(""),G(""),oe("")):(console.error("[ChangePassword] API Error:",S.message),_(S.message))}catch(S){console.error("[ChangePassword] Unexpected error:",S),X(!1),_("An unexpected error occurred.")}};return e.jsx(vs,{children:e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:n}),e.jsxs(Ns.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative bg-white dark:bg-slate-900 rounded-2xl shadow-2xl p-6 max-w-md w-full border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(De,{size:20,className:"text-accent-600"})," Change Password"]}),e.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors",children:e.jsx(ne,{size:20})})]}),Q&&e.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 flex items-start gap-3",children:[e.jsx(ws,{className:"text-red-600 dark:text-red-400 shrink-0",size:20}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:Q})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx($e,{label:"Current Password",value:j,onChange:N=>m(N.target.value),show:Y,toggleShow:()=>ce(!Y)}),e.jsx($e,{label:"New Password",value:C,onChange:N=>G(N.target.value),show:M,toggleShow:()=>fe(!M)}),e.jsx($e,{label:"Confirm New Password",value:q,onChange:N=>oe(N.target.value),show:K,toggleShow:()=>Oe(!K)}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:W,className:"px-6 py-2 bg-accent-600 text-white hover:bg-accent-700 rounded-lg font-medium transition-colors shadow-lg shadow-accent-600/20 disabled:opacity-70 disabled:cursor-not-allowed flex items-center gap-2",children:[W?e.jsx(p,{className:"animate-spin",size:18}):e.jsx(Me,{size:18}),"Update Password"]})]})]})]})]})})},Wt=()=>{var os,cs,xs,ms;const{user:t,logout:n,isLoading:h,checkAuth:b}=ks(),j=st(),[m,C]=d.useState("overview"),[G,q]=d.useState([]),[oe,Y]=d.useState(!1),[ce,M]=d.useState([]),[fe,K]=d.useState(!1),[Oe,Q]=d.useState(null),[_,W]=d.useState([]),[X,Z]=d.useState(!1),[N,S]=d.useState([]),[Ve,Te]=d.useState(!1),[Fe,Cs]=d.useState([]),[v,Is]=d.useState(null),[As,Ge]=d.useState(!1),[_s,D]=d.useState(!1),[u,L]=d.useState({userEmail:"",expertId:"",expertName:"",licenseType:"basic",expirationDate:"",maxAccounts:1,isActive:!0}),[ee,Be]=d.useState("add"),[I,je]=d.useState(null),[se,He]=d.useState({public:[],pending:[],rejected:[]}),[Et,Je]=d.useState(!1),[o,qe]=d.useState(null),[Ye,xe]=d.useState(!1),[Ss,Ke]=d.useState(!1),[Qe,We]=d.useState(""),[te,Xe]=d.useState(null),[Ze,ye]=d.useState(null),[es,zs]=d.useState([]),[B,ae]=d.useState(null),[Es,ss]=d.useState(!1),[Ls,me]=d.useState(!1),[k,R]=d.useState(null),[ve,ts]=d.useState({show:!1,type:"success",message:""}),[re,g]=d.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),[he,pe]=d.useState({isOpen:!1,postId:null}),[Ne,ke]=d.useState({isOpen:!1,userId:null}),[le,we]=d.useState({isOpen:!1,userId:null}),[Rs,as]=d.useState(!1),[Pe,be]=d.useState(!1),[y,U]=d.useState({}),rs=d.useRef(null),[c,x]=d.useState({}),i=(s,a)=>{ts({show:!0,type:s,message:a})};d.useEffect(()=>{!h&&!t&&j("/auth/login")},[h,t,j]);const Us=s=>{const a=s.verification;if(!a)return{status:lt.UNVERIFIED,emailVerified:!1,identityVerified:!1,identityStatus:"unverified"};let r="unverified";return a.identity.verified?r="verified":a.rejectionReason&&!a.identity.documentKey&&!a.identity.documentUrl||a.rejectionReason?r="rejected":(a.identity.documentKey||a.identity.documentUrl)&&(r="pending"),{status:a.overall,emailVerified:a.email.verified,identityVerified:a.identity.verified,identityStatus:r,rejectionReason:a.rejectionReason}};d.useEffect(()=>{if(t&&t.verification&&(qe(Us(t)),t.verificationPreview)){if(typeof t.verificationPreview=="string")ye(t.verificationPreview);else if(typeof t.verificationPreview=="object"){const s=t.verificationPreview;ye(s.presignedUrl||s.documentUrl||null)}}t&&!Pe&&U({username:t.username||"",phoneNumber:t.phoneNumber||"",passportId:t.passportId||"",address:t.address||"",country:t.country||"",city:t.city||""})},[t]);const $s=async()=>{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="moderator"){K(!0),Q(null);try{const s=await E.getModerationPosts();M(s)}catch(s){console.error("Error fetching moderation posts:",s),Q(s.message||"Failed to load"),i("error","Failed to fetch moderation queue")}finally{K(!1)}}},de=async()=>{Ge(!0);try{const[s,a]=await Promise.all([J.getUsers(),J.getStats()]);Cs(s.users),Is(a.stats)}catch(s){console.error("Expert Data Fetch Error",s),i("error","Failed to load expert data: "+s.message)}finally{Ge(!1)}},Ce=async()=>{xe(!0);try{const s=await $.getStatus();qe(s)}catch(s){console.error("Fetch verification status failed:",s)}finally{xe(!1)}},Ie=async()=>{xe(!0);try{const s=await $.getPendingRequests();zs(s)}catch(s){console.error("[Dashboard] Error fetching verifications:",s)}finally{xe(!1)}},ls=async()=>{Te(!0);try{const s=await ie.getAll();S(s)}catch(s){console.error("Error fetching users",s)}finally{Te(!1)}};d.useEffect(()=>{(m==="blog"||m==="overview")&&t&&(Y(!0),E.getMyPosts(t._id||"").then(s=>{q(s),Y(!1)})),m==="moderation"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="moderator")&&$s(),(m==="users"||m==="admin_profiles")&&(t==null?void 0:t.role)==="admin"&&ls(),m==="expert_systems"&&(t==null?void 0:t.role)==="admin"&&de(),m==="liked"&&t&&(Z(!0),E.getAllPublic().then(s=>{const a=String(t._id||""),r=String(t.user_id||""),l=new Set;Array.isArray(t.likedPosts)&&t.likedPosts.forEach(w=>{const H=typeof w=="object"&&w?w._id:w;H&&l.add(String(H))});const z=s.filter(w=>{const H=Array.isArray(w.likedBy)&&w.likedBy.some(f=>{const Se=typeof f=="object"&&f?f._id||f.user_id:f,hs=String(Se);return a&&hs===a||r&&hs===r}),_e=l.has(String(w._id));return H||_e});W(z),Z(!1)}).catch(s=>{console.error("Failed to fetch liked posts",s),Z(!1)})),(m==="verification"||m==="overview")&&t&&Ce(),m==="admin_verifications"&&(t==null?void 0:t.role)==="admin"&&Ie(),m!=="users"&&je(null)},[m,t]);const Ms=async s=>{s.preventDefault(),x(a=>({...a,expert_submit:!0}));try{if(ee==="add"){const a=await J.addUser(u);a.success&&(i("success",a.message),D(!1),de())}else{const a=await J.updateUser(u.userEmail,u.expertId,{expertName:u.expertName,licenseType:u.licenseType,expirationDate:u.expirationDate,maxAccounts:u.maxAccounts,isActive:u.isActive});a.success&&(i("success",a.message),D(!1),de())}}catch(a){i("error",a.message||"Operation failed")}finally{x(a=>({...a,expert_submit:!1}))}},Ds=(s,a)=>{L({userEmail:s.email,expertId:a.expertId,expertName:a.expertName,licenseType:a.licenseType,expirationDate:a.expirationDate?new Date(a.expirationDate).toISOString().split("T")[0]:"",maxAccounts:a.maxAccounts||1,isActive:a.isActive}),Be("edit"),D(!0)},Os=async(s,a,r)=>{x(l=>({...l,[`toggle_${s}_${a}`]:!0}));try{const l=await J.toggleAccess(s,a,!r);l.success&&(i("success",l.message),de())}catch(l){i("error",l.message)}finally{x(l=>({...l,[`toggle_${s}_${a}`]:!1}))}},Vs=(s,a)=>{g({isOpen:!0,title:"Remove Expert Access",message:`Are you sure you want to remove expert ${a} from user ${s}?`,isLoading:!1,onConfirm:async()=>{g(r=>({...r,isLoading:!0}));try{const r=await J.removeUser(s,a);r.success&&(i("success",r.message),de(),g(l=>({...l,isOpen:!1})))}catch(r){i("error",r.message),g(l=>({...l,isLoading:!1}))}}})},Ts=async()=>{x(s=>({...s,otp:!0}));try{const s=await $.sendEmailOtp();s.success&&(Ke(!0),i("success",s.message))}catch(s){i("error",s.message)}finally{x(s=>({...s,otp:!1}))}},Fs=async()=>{x(s=>({...s,otp_confirm:!0}));try{const s=await $.confirmEmailOtp(Qe);s.success&&(i("success",s.message),Ce(),Ke(!1),We(""))}catch(s){i("error",s.message)}finally{x(s=>({...s,otp_confirm:!1}))}},Gs=s=>{if(s.target.files&&s.target.files[0]){const a=s.target.files[0];if(a.size>5*1024*1024){i("error","File size exceeds 5MB limit.");return}if(!["image/jpeg","image/png"].includes(a.type)){i("error","Only JPG and PNG allowed.");return}Xe(a),ye(URL.createObjectURL(a))}},Bs=async()=>{if(te){x(s=>({...s,upload:!0}));try{const s=await $.uploadIdentity(te);s.success&&(i("success",s.message),Xe(null),Ce())}catch(s){i("error",s.message)}finally{x(s=>({...s,upload:!1}))}}},Hs=async s=>{const a=s.userId||s._id;if(!a){i("error","Invalid User ID");return}x(r=>({...r,[`view-${a}`]:!0})),ss(!1),me(!0);try{const r=await $.getPresignedUrl(a);ae({req:s,url:r.url,userId:a})}catch(r){i("error",r.message),me(!1)}finally{x(r=>({...r,[`view-${a}`]:!1}))}},Js=async s=>{x(a=>({...a,approve_id:!0}));try{(await $.approveIdentity(s)).success&&(i("success","Identity Approved"),ae(null),Ie())}catch(a){i("error",a.message)}finally{x(a=>({...a,approve_id:!1}))}},qs=async(s,a)=>{x(r=>({...r,reject_id:!0}));try{(await $.rejectIdentity(s,a)).success&&(i("success","Identity Rejected"),ae(null),ke({isOpen:!1,userId:null}),Ie())}catch(r){i("error",r.message)}finally{x(r=>({...r,reject_id:!1}))}},Ys=async s=>{if(s.target.files&&s.target.files[0]){const a=s.target.files[0];x(r=>({...r,avatar:!0}));try{const r=await ie.uploadProfilePic(a);r.success&&(i("success",r.message),await b())}catch(r){i("error",r.message)}finally{x(r=>({...r,avatar:!1}))}}},Ks=async s=>{s.preventDefault(),x(a=>({...a,profile_update:!0}));try{(await ie.updateProfile(y)).success&&(i("success","Profile updated successfully"),be(!1),await b())}catch(a){let r=a.message;const l=r.toLowerCase();(l.includes("duplicate")||l.includes("already exists")||l.includes("e11000"))&&(l.includes("username")?r="Username is already taken. Please choose a different one.":l.includes("phone")?r="Phone number is already associated with another account.":l.includes("passport")?r="Passport ID is already in use.":l.includes("email")?r="Email is already in use.":r="This information is already in use by another account."),i("error",r)}finally{x(a=>({...a,profile_update:!1}))}},ds=async(s,a,r)=>{x(l=>({...l,[`prof_${s}`]:!0}));try{(await ie.verifyProfile(s,a,r)).success&&(i("success",`Profile ${a}`),we({isOpen:!1,userId:null}),ls())}catch(l){i("error",l.message)}finally{x(l=>({...l,[`prof_${s}`]:!1}))}},is=async s=>{x(a=>({...a,[s]:!0}));try{const a=await E.approve(s);a.success?(M(r=>r.filter(l=>l._id!==s)),I&&Ae(I),k&&k._id===s&&R(null),i("success",a.message)):i("error","Action failed")}catch{i("error","An error occurred")}finally{x(a=>({...a,[s]:!1}))}},Qs=async(s,a)=>{x(r=>({...r,[s]:!0}));try{const r=await E.reject(s,a);r.success?(M(l=>l.filter(z=>z._id!==s)),I&&Ae(I),k&&k._id===s&&R(null),pe({isOpen:!1,postId:null}),i("success",r.message)):i("error","Action failed")}catch{i("error","An error occurred")}finally{x(r=>({...r,[s]:!1}))}},Ws=s=>{g({isOpen:!0,title:"Delete Post",message:"Are you sure you want to delete this post? This action cannot be undone.",isLoading:!1,onConfirm:async()=>{g(a=>({...a,isLoading:!0})),x(a=>({...a,[s]:!0}));try{const a=await E.delete(s);a.success?(i("success",a.message),q(r=>r.filter(l=>l._id!==s)),M(r=>r.filter(l=>l._id!==s)),W(r=>r.filter(l=>l._id!==s)),I&&He(r=>({...r,public:r.public.filter(l=>l._id!==s),pending:r.pending.filter(l=>l._id!==s),rejected:r.rejected.filter(l=>l._id!==s)})),g(r=>({...r,isOpen:!1}))):(i("error",a.message),g(r=>({...r,isLoading:!1})))}catch{i("error","Failed to delete post"),g(r=>({...r,isLoading:!1}))}finally{x(a=>({...a,[s]:!1}))}}})},ns=async s=>{if(R(s),!s.content&&!s.contentRaw)try{const a=await E.getById(s._id);a&&R(a)}catch(a){console.error("Failed to fetch full post details",a)}},Xs=(s,a)=>{g({isOpen:!0,title:"Change User Role",message:`Are you sure you want to change this user's role to ${a}?`,isLoading:!1,onConfirm:async()=>{g(r=>({...r,isLoading:!0})),x(r=>({...r,[`role-${s}`]:!0}));try{const r=await ie.updateRole(s,a);r.success?(i("success",r.message),S(l=>l.map(z=>z._id===s?{...z,role:a}:z)),g(l=>({...l,isOpen:!1}))):(i("error",r.message),g(l=>({...l,isLoading:!1})))}catch(r){i("error",r.message||"Failed to update role"),g(l=>({...l,isLoading:!1}))}finally{x(r=>({...r,[`role-${s}`]:!1}))}}})},Ae=async s=>{je(s),Je(!0);try{const[a,r]=await Promise.all([E.getAllPublic(),E.getModerationPosts()]),l=f=>{const Se=typeof f.authorId=="object"&&f.authorId?f.authorId._id:f.authorId;return String(Se)===String(s._id)},z=a.filter(l),w=r.filter(l),H=w.filter(f=>f.visibility==="pending"),_e=w.filter(f=>f.visibility==="rejected");He({public:z,pending:H,rejected:_e})}catch(a){console.error("Error inspecting user",a),i("error","Failed to load user posts")}finally{Je(!1)}},Zs=()=>Ye?e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg",children:e.jsx(ze,{size:20})}),e.jsx("h3",{className:"font-semibold text-slate-700 dark:text-slate-300",children:"Account Status"})]}),e.jsxs("div",{className:"space-y-4 flex-1 animate-pulse",children:[e.jsx("div",{className:"h-12 bg-slate-100 dark:bg-slate-800/50 rounded-lg"}),e.jsx("div",{className:"h-12 bg-slate-100 dark:bg-slate-800/50 rounded-lg"})]})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg",children:e.jsx(ze,{size:20})}),e.jsx("h3",{className:"font-semibold text-slate-700 dark:text-slate-300",children:"Account Status"})]}),e.jsxs("div",{className:"space-y-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Level 1 (Email)"}),o!=null&&o.emailVerified?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-2 py-1 rounded-full",children:[e.jsx(O,{size:12})," Verified"]}):e.jsx("span",{className:"flex items-center gap-1.5 text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-full",children:"Unverified"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Level 2 (Identity)"}),o!=null&&o.identityVerified||(o==null?void 0:o.status)==="FULLY_VERIFIED"?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-2 py-1 rounded-full",children:[e.jsx(O,{size:12})," Verified"]}):(o==null?void 0:o.identityStatus)==="pending"||(o==null?void 0:o.status)==="PENDING"?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs font-bold text-yellow-600 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/20 px-2 py-1 rounded-full",children:[e.jsx(Ee,{size:12})," Pending"]}):e.jsx("span",{className:"flex items-center gap-1.5 text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-full",children:"Unverified"})]})]})]}),et=async()=>{await n(),j("/")},A=({id:s,label:a,icon:r})=>e.jsxs("button",{onClick:()=>C(s),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${m===s?"bg-accent-600 text-white shadow-md shadow-accent-600/20":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-white"}`,children:[e.jsx(r,{size:18}),a]});return h?e.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center bg-slate-50 dark:bg-slate-950",children:e.jsxs("div",{className:"text-slate-600 dark:text-slate-400 font-medium animate-pulse flex items-center gap-2",children:[e.jsx(p,{className:"animate-spin"})," Loading dashboard..."]})}):t?e.jsxs("div",{className:"min-h-screen pt-24 pb-12 bg-slate-50 dark:bg-slate-950 px-4 sm:px-6 lg:px-8 transition-colors duration-500",children:[e.jsx(it,{show:ve.show,type:ve.type,message:ve.message,onClose:()=>ts(s=>({...s,show:!1}))}),e.jsx(nt,{isOpen:re.isOpen,title:re.title,message:re.message,isLoading:re.isLoading,onClose:()=>g(s=>({...s,isOpen:!1})),onConfirm:re.onConfirm}),_s&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/80 backdrop-blur-sm",onClick:()=>D(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-2xl w-full max-w-lg shadow-2xl border border-slate-200 dark:border-slate-800 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-900",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:ee==="add"?"Grant Expert Access":"Edit Access"}),e.jsx("button",{onClick:()=>D(!1),children:e.jsx(ne,{size:20,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"})})]}),e.jsxs("form",{onSubmit:Ms,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"User Email"}),e.jsx("input",{type:"email",required:!0,disabled:ee==="edit",value:u.userEmail,onChange:s=>L({...u,userEmail:s.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white disabled:opacity-60",placeholder:"user@example.com"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"Expert ID"}),e.jsx("input",{type:"text",required:!0,disabled:ee==="edit",value:u.expertId,onChange:s=>L({...u,expertId:s.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white disabled:opacity-60",placeholder:"EA_001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"Expert Name"}),e.jsx("input",{type:"text",value:u.expertName,onChange:s=>L({...u,expertName:s.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white",placeholder:"Trend Scout Pro"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"License Type"}),e.jsxs("select",{value:u.licenseType,onChange:s=>L({...u,licenseType:s.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white",children:[e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"trial",children:"Trial"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"Max Accounts"}),e.jsx("input",{type:"number",min:"1",value:u.maxAccounts,onChange:s=>L({...u,maxAccounts:parseInt(s.target.value)||1}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:"Expiration Date (Optional)"}),e.jsx("input",{type:"date",value:u.expirationDate,onChange:s=>L({...u,expirationDate:s.target.value}),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>D(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:c.expert_submit,className:"px-6 py-2 bg-accent-600 text-white rounded-lg font-bold hover:bg-accent-700 transition-colors shadow-lg shadow-accent-600/20 disabled:opacity-70 flex items-center gap-2",children:[c.expert_submit?e.jsx(p,{size:18,className:"animate-spin"}):e.jsx(Me,{size:18}),ee==="add"?"Grant Access":"Update Access"]})]})]})]})]}),e.jsx(Ue,{isOpen:he.isOpen,isProcessing:c[he.postId||""],onClose:()=>pe(s=>({...s,isOpen:!1})),onConfirm:s=>{he.postId&&Qs(he.postId,s)}}),e.jsx(Ue,{isOpen:Ne.isOpen,isProcessing:c.reject_id,onClose:()=>ke(s=>({...s,isOpen:!1})),onConfirm:s=>{Ne.userId&&qs(Ne.userId,s)}}),e.jsx(Ue,{isOpen:le.isOpen,isProcessing:le.userId?c[`prof_${le.userId}`]:!1,onClose:()=>we(s=>({...s,isOpen:!1})),onConfirm:s=>{le.userId&&ds(le.userId,"rejected",s)}}),e.jsx(zt,{isOpen:Rs,onClose:()=>as(!1),onSuccess:()=>i("success","Password updated successfully")}),k&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/80 backdrop-blur-sm",onClick:()=>R(null)}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col shadow-2xl border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-lg dark:text-white",children:["Reviewing: ",k.title]}),e.jsx("button",{onClick:()=>R(null),children:e.jsx(ne,{size:20,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50 dark:bg-slate-950",children:e.jsx(ot,{content:k.content||k.contentRaw,title:k.title})}),e.jsxs("div",{className:"p-4 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{pe({isOpen:!0,postId:k._id}),R(null)},className:"px-4 py-2 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 rounded-lg font-bold",children:"Reject"}),e.jsx("button",{onClick:()=>{is(k._id),R(null)},className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-bold hover:bg-emerald-700",children:"Approve & Publish"})]})]})]}),B&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/90 backdrop-blur-md",onClick:()=>ae(null)}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-900 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-900",children:[e.jsxs("h3",{className:"font-bold text-lg dark:text-white flex items-center gap-2",children:[e.jsx(ps,{size:20,className:"text-emerald-500"}),"Review Identity: ",B.req.userEmail]}),e.jsx("button",{onClick:()=>ae(null),children:e.jsx(ne,{size:20,className:"text-slate-500"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-100 dark:bg-black flex items-center justify-center",children:[Ls&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50 z-10",children:e.jsx(p,{className:"animate-spin text-emerald-500",size:32})}),Es?e.jsxs("div",{className:"text-center p-8 text-red-500 bg-red-50 dark:bg-red-900/10 rounded-xl border border-red-200 dark:border-red-900",children:[e.jsx(bs,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Failed to load document image."}),e.jsx("p",{className:"text-xs mt-2 opacity-70",children:"The URL may have expired or is invalid."})]}):e.jsx("img",{src:B.url,alt:"ID Document",className:"max-w-full max-h-[60vh] object-contain rounded-lg shadow-lg border border-slate-200 dark:border-slate-800",onLoad:()=>me(!1),onError:()=>{ss(!0),me(!1)}})]}),e.jsxs("div",{className:"p-4 border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex justify-between items-center",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:["User ID: ",e.jsx("span",{className:"font-mono",children:B.userId})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ke({isOpen:!0,userId:B.userId}),disabled:c.reject_id,className:"px-4 py-2 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-lg font-bold hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:"Reject"}),e.jsxs("button",{onClick:()=>Js(B.userId),disabled:c.approve_id,className:"px-6 py-2 bg-emerald-600 text-white rounded-lg font-bold hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-600/20 disabled:opacity-70 disabled:cursor-wait flex items-center gap-2",children:[c.approve_id&&e.jsx(p,{size:16,className:"animate-spin"}),"Approve Identity"]})]})]})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col md:flex-row gap-8",children:[e.jsx("aside",{className:"w-full md:w-64 shrink-0",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 sticky top-24",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-accent-100 dark:bg-accent-900/30 text-accent-600 dark:text-accent-400 flex items-center justify-center font-bold text-xl overflow-hidden relative group shrink-0",children:t.profilePic?e.jsx("img",{src:t.profilePic,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("span",{children:t.firstName[0]})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-slate-900 dark:text-white truncate",title:`${t.firstName} ${t.lastName}`,children:[t.firstName," ",t.lastName]}),e.jsx("p",{className:"text-xs text-slate-500 truncate",title:t.username?`@${t.username}`:t.email,children:t.username?`@${t.username}`:t.email})]})]}),e.jsxs("nav",{className:"space-y-1",children:[e.jsx(A,{id:"overview",label:"Overview",icon:tt}),e.jsx(A,{id:"profile",label:"My Profile",icon:ps}),e.jsx(A,{id:"blog",label:"My Posts",icon:Re}),e.jsx(A,{id:"liked",label:"Liked Posts",icon:xt}),e.jsx(A,{id:"verification",label:"Verification",icon:St}),(t.role==="admin"||t.role==="moderator")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-4 border-t border-slate-100 dark:border-slate-800"}),e.jsx("h4",{className:"px-4 text-xs font-bold text-slate-400 uppercase mb-2",children:"Staff Area"}),e.jsx(A,{id:"moderation",label:"Moderation Queue",icon:ze})]}),t.role==="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(A,{id:"admin_verifications",label:"ID Verification",icon:ft}),e.jsx(A,{id:"admin_profiles",label:"Profile Reviews",icon:fs}),e.jsx(A,{id:"expert_systems",label:"Expert Access",icon:js}),e.jsx(A,{id:"users",label:"User Management",icon:dt})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-slate-100 dark:border-slate-800",children:e.jsxs("button",{onClick:et,className:"w-full flex items-center gap-3 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:[e.jsx(at,{size:18})," Sign Out"]})})]})}),e.jsxs("main",{className:"flex-1 min-w-0",children:[m==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Dashboard Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Zs(),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-lg",children:e.jsx(Re,{size:20})}),e.jsx("h3",{className:"font-semibold text-slate-700 dark:text-slate-300",children:"My Contributions"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 dark:text-white mb-1",children:G.length}),e.jsx("p",{className:"text-sm text-slate-500",children:"Total posts created"}),e.jsxs(ue,{to:"/blog/editor",className:"mt-4 inline-flex items-center text-sm text-accent-600 hover:underline",children:["Write new post ",e.jsx(us,{className:"rotate-180 ml-1",size:14})]})]})]}),!t.username&&!t.phoneNumber&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 shadow-lg text-white flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"Complete your Profile"}),e.jsx("p",{className:"text-indigo-100 text-sm",children:"Add your username and details to get verified faster."})]}),e.jsx("button",{onClick:()=>{C("profile"),be(!0)},className:"px-6 py-2 bg-white text-indigo-600 font-bold rounded-lg hover:bg-indigo-50 transition-colors shadow-md whitespace-nowrap",children:"Update Profile"})]})]}),m==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"My Profile"}),!Pe&&e.jsxs("button",{onClick:()=>be(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-lg font-medium hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:[e.jsx(ge,{size:16})," Edit Profile"]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-8 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8 mb-8 pb-8 border-b border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-accent-100 dark:bg-accent-900/30 text-accent-600 dark:text-accent-400 flex items-center justify-center font-bold text-4xl border-4 border-slate-50 dark:border-slate-800 overflow-hidden",children:t.profilePic?e.jsx("img",{src:t.profilePic,alt:"Profile",className:"w-full h-full object-cover"}):t.firstName[0]}),e.jsx("input",{type:"file",ref:rs,className:"hidden",accept:"image/png, image/jpeg",onChange:Ys}),e.jsx("button",{onClick:()=>{var s;return(s=rs.current)==null?void 0:s.click()},disabled:c.avatar,className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer disabled:cursor-wait",children:c.avatar?e.jsx(p,{className:"animate-spin text-white"}):e.jsx(bt,{className:"text-white",size:24})})]}),e.jsxs("div",{className:"text-center md:text-left space-y-2 flex-1",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 justify-center md:justify-start",children:[e.jsxs("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[t.firstName," ",t.lastName]}),((os=t.profileVerification)==null?void 0:os.status)==="verified"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-xs font-bold rounded-full border border-blue-200 dark:border-blue-800",children:[e.jsx(fs,{size:12})," Verified Profile"]}),((cs=t.profileVerification)==null?void 0:cs.status)==="pending"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 text-xs font-bold rounded-full border border-yellow-200 dark:border-yellow-800",children:[e.jsx(Ee,{size:12})," Pending Review"]}),((xs=t.profileVerification)==null?void 0:xs.status)==="rejected"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-bold rounded-full border border-red-200 dark:border-red-800",title:t.profileVerification.rejectionReason||"Profile rejected",children:[e.jsx(ne,{size:12})," Rejected"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 text-sm text-slate-500 dark:text-slate-400",children:[t.username&&e.jsxs("span",{className:"text-accent-600 dark:text-accent-400 font-medium",children:["@",t.username]}),t.city&&t.country&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ys,{size:14})," ",t.city,", ",t.country]})]}),((ms=t.profileVerification)==null?void 0:ms.status)==="rejected"&&t.profileVerification.rejectionReason&&e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-600 dark:text-red-400 mt-2 text-left",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",t.profileVerification.rejectionReason]})]})]}),Pe?e.jsxs("form",{onSubmit:Ks,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Username"}),e.jsx("input",{type:"text",value:y.username||"",onChange:s=>U({...y,username:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white",placeholder:"@username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Phone Number"}),e.jsx("input",{type:"text",value:y.phoneNumber||"",onChange:s=>U({...y,phoneNumber:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Passport ID"}),e.jsx("input",{type:"text",value:y.passportId||"",onChange:s=>U({...y,passportId:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Address"}),e.jsx("input",{type:"text",value:y.address||"",onChange:s=>U({...y,address:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Country"}),e.jsx("input",{type:"text",value:y.country||"",onChange:s=>U({...y,country:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"City"}),e.jsx("input",{type:"text",value:y.city||"",onChange:s=>U({...y,city:s.target.value}),className:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-accent-500 dark:text-white"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/30 rounded-lg text-sm text-yellow-800 dark:text-yellow-400 flex gap-3",children:[e.jsx(yt,{className:"shrink-0",size:20}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"}),' Updating sensitive profile information (Passport ID, Address, Phone) will require re-verification by our administrators. Your profile status will be set to "Pending Review".']})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("button",{type:"button",onClick:()=>{be(!1),U({...t})},className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:c.profile_update,className:"px-6 py-2 bg-accent-600 text-white hover:bg-accent-700 rounded-lg font-medium transition-colors shadow-lg shadow-accent-600/20 disabled:opacity-70 disabled:cursor-wait flex items-center gap-2",children:[c.profile_update?e.jsx(p,{className:"animate-spin",size:18}):e.jsx(Me,{size:18}),"Save Changes"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950 p-6 rounded-xl border border-slate-100 dark:border-slate-800 space-y-4",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-800 pb-2 mb-4",children:"Contact Info"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(rt,{className:"text-slate-400 mt-0.5",size:18}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase font-bold",children:"Email"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:t.email})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ct,{className:"text-slate-400 mt-0.5",size:18}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase font-bold",children:"Phone"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:t.phoneNumber||"Not set"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950 p-6 rounded-xl border border-slate-100 dark:border-slate-800 space-y-4",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white border-b border-slate-200 dark:border-slate-800 pb-2 mb-4",children:"Identity & Location"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ys,{className:"text-slate-400 mt-0.5",size:18}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase font-bold",children:"Address"}),e.jsxs("span",{className:"text-slate-700 dark:text-slate-300",children:[t.address?t.address:"Not set",t.city&&`, ${t.city}`,t.country&&`, ${t.country}`]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(kt,{className:"text-slate-400 mt-0.5",size:18}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase font-bold",children:"Passport / National ID"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:t.passportId?`${t.passportId.substring(0,2)}${"*".repeat(Math.max(0,t.passportId.length-4))}${t.passportId.slice(-2)}`:"Not set"})]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("h4",{className:"font-bold text-slate-900 dark:text-white mb-4",children:"Security Settings"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between p-4 bg-slate-50 dark:bg-slate-950 rounded-lg border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 sm:mb-0",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-slate-900 rounded-full border border-slate-200 dark:border-slate-800 text-slate-500",children:e.jsx(De,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:"Password"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Last changed: Never"})]})]}),e.jsx("button",{onClick:()=>as(!0),className:"px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors shadow-sm",children:"Change Password"})]})]})]})]}),m==="blog"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"My Posts"}),e.jsxs(ue,{to:"/blog/editor",className:"px-4 py-2 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors text-sm font-medium flex items-center gap-2",children:[e.jsx(ge,{size:16})," New Post"]})]}),oe?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-600"})}):G.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-900 rounded-xl border border-dashed border-slate-300 dark:border-slate-700",children:e.jsx("p",{className:"text-slate-500",children:"You haven't written any posts yet."})}):e.jsx("div",{className:"space-y-4",children:G.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:s.title}),e.jsxs("div",{className:"flex gap-2 text-xs mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded capitalize ${s.visibility==="public"?"bg-green-100 text-green-700":s.visibility==="pending"?"bg-yellow-100 text-yellow-700":s.visibility==="rejected"?"bg-red-100 text-red-700":"bg-slate-100 text-slate-600"}`,children:s.visibility}),e.jsx("span",{className:"text-slate-400",children:new Date(s.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{to:`/blog/editor/${s._id}`,className:"p-2 text-slate-500 hover:text-accent-600 hover:bg-slate-100 dark:hover:bg-slate-800 rounded transition-colors",children:e.jsx(ge,{size:18})}),e.jsx("button",{onClick:()=>Ws(s._id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",children:e.jsx(gs,{size:18})})]})]},s._id))})]}),m==="expert_systems"&&(t==null?void 0:t.role)==="admin"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Expert Access Management"}),e.jsxs("button",{onClick:()=>{L({userEmail:"",expertId:"",expertName:"",licenseType:"basic",expirationDate:"",maxAccounts:1,isActive:!0}),Be("add"),D(!0)},className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-bold flex items-center gap-2 hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-600/20",children:[e.jsx(js,{size:18})," Grant Access"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:"Total Licenses"}),e.jsx("div",{className:"text-2xl font-black text-slate-900 dark:text-white mt-1",children:(v==null?void 0:v.totalUsers)||0})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:"Active Users"}),e.jsx("div",{className:"text-2xl font-black text-emerald-600 dark:text-emerald-400 mt-1",children:(v==null?void 0:v.activeUsers)||0})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:"Total Trades"}),e.jsx("div",{className:"text-2xl font-black text-slate-900 dark:text-white mt-1",children:((v==null?void 0:v.totalTrades)||0).toLocaleString()})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:"System Profit"}),e.jsxs("div",{className:"text-2xl font-black text-green-600 dark:text-green-400 mt-1",children:["$",((v==null?void 0:v.totalProfit)||0).toLocaleString()]})]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left min-w-[800px]",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-xs uppercase font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"User"}),e.jsx("th",{className:"px-6 py-4",children:"Expert System"}),e.jsx("th",{className:"px-6 py-4",children:"License"}),e.jsx("th",{className:"px-6 py-4",children:"Expires"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-800",children:As?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsx(p,{className:"animate-spin mx-auto text-emerald-600"})})}):Fe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-500",children:"No active expert licenses found."})}):Fe.map(s=>s.experts.map((a,r)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-bold text-slate-900 dark:text-white",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-xs text-slate-500",children:s.email})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:a.expertName}),e.jsx("div",{className:"text-xs text-slate-500 font-mono",children:a.expertId})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex px-2 py-1 rounded text-xs font-bold uppercase bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700",children:a.licenseType})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-600 dark:text-slate-400",children:a.expirationDate?new Date(a.expirationDate).toLocaleDateString():"Lifetime"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-bold ${a.isActive?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${a.isActive?"bg-emerald-500":"bg-red-500"}`}),a.isActive?"Active":"Suspended"]})}),e.jsxs("td",{className:"px-6 py-4 text-right flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>Ds(s,a),className:"p-1.5 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 rounded transition-colors",title:"Edit Access",children:e.jsx(ge,{size:16})}),e.jsx("button",{onClick:()=>Os(s.email,a.expertId,a.isActive),className:`p-1.5 rounded transition-colors ${a.isActive?"text-slate-500 hover:text-amber-600 hover:bg-amber-50 dark:hover:bg-amber-900/20":"text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"}`,title:a.isActive?"Suspend":"Activate",disabled:c[`toggle_${s.email}_${a.expertId}`],children:c[`toggle_${s.email}_${a.expertId}`]?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(At,{size:16})}),e.jsx("button",{onClick:()=>Vs(s.email,a.expertId),className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Revoke Access",children:e.jsx(gs,{size:16})})]})]},`${s.email}-${r}`)))})]})})})]}),m==="verification"&&e.jsxs("div",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Account Verification"}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 p-6 rounded-xl border ${o!=null&&o.emailVerified?"border-green-200 dark:border-green-900/50":"border-slate-200 dark:border-slate-800"} relative overflow-hidden`,children:[(o==null?void 0:o.emailVerified)&&e.jsx("div",{className:"absolute top-0 right-0 p-4",children:e.jsx(O,{className:"text-green-500",size:24})}),e.jsx("h3",{className:"font-bold text-lg mb-2 dark:text-white",children:"Level 1: Email Verification"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Required for basic commenting and posting."}),o!=null&&o.emailVerified?e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full text-sm font-bold",children:[e.jsx(O,{size:16})," Verified"]}):e.jsx("div",{className:"space-y-4 max-w-sm",children:Ss?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Enter OTP",className:"flex-1 px-4 py-2 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg outline-none",value:Qe,onChange:s=>We(s.target.value)}),e.jsx("button",{onClick:Fs,disabled:c.otp_confirm,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:c.otp_confirm?e.jsx(p,{className:"animate-spin"}):"Confirm"})]}):e.jsx("button",{onClick:Ts,disabled:c.otp,className:"px-4 py-2 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors disabled:opacity-50",children:c.otp?e.jsx(p,{className:"animate-spin"}):"Send Verification Code"})})]}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 p-6 rounded-xl border ${o!=null&&o.identityVerified?"border-green-200 dark:border-green-900/50":"border-slate-200 dark:border-slate-800"} relative overflow-hidden`,children:[(o==null?void 0:o.identityVerified)&&e.jsx("div",{className:"absolute top-0 right-0 p-4",children:e.jsx(O,{className:"text-green-500",size:24})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-bold text-lg dark:text-white",children:"Level 2: Identity Verification"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Required for advanced features and badge."})]}),o!=null&&o.identityVerified?e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full text-sm font-bold",children:[e.jsx(O,{size:16})," Verified"]}):(o==null?void 0:o.identityStatus)==="pending"?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-100 dark:border-yellow-900/30 rounded-lg text-yellow-800 dark:text-yellow-400 flex items-start gap-3",children:[e.jsx(Ee,{className:"shrink-0 mt-0.5",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Under Review"}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:"Your document has been uploaded and is waiting for administrator approval."})]})]}),Ze&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 mb-2",children:"Submitted Document:"}),e.jsx("img",{src:Ze,alt:"Uploaded Doc",className:"h-32 rounded border border-slate-200 dark:border-slate-700"})]})]}):e.jsxs("div",{className:"space-y-4 max-w-sm",children:[(o==null?void 0:o.rejectionReason)&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-900/30 rounded-lg text-red-800 dark:text-red-400 mb-4",children:[e.jsxs("p",{className:"font-bold text-sm flex items-center gap-2",children:[e.jsx(bs,{size:16})," Application Rejected"]}),e.jsxs("p",{className:"text-xs mt-1",children:["Reason: ",o.rejectionReason]})]}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-6 text-center hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors relative",children:[e.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:"image/jpeg,image/png",onChange:Gs}),e.jsx(mt,{className:"mx-auto text-slate-400 mb-2",size:24}),e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:te?te.name:"Click to upload ID (JPG/PNG)"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Max 5MB"})]}),te&&e.jsx("button",{onClick:Bs,disabled:c.upload,className:"w-full px-4 py-2 bg-accent-600 text-white rounded-lg hover:bg-accent-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:c.upload?e.jsx(p,{className:"animate-spin",size:18}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{size:18})," Submit Document"]})})]})]})]}),m==="moderation"&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="moderator")&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Moderation Queue"}),fe?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-600"})}):ce.length===0?e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-slate-900 rounded-xl border border-dashed border-slate-200 dark:border-slate-800 text-slate-500",children:[e.jsx(O,{className:"mx-auto mb-2 text-green-500",size:32}),e.jsx("p",{children:"All caught up! No pending posts."})]}):e.jsx("div",{className:"space-y-4",children:ce.map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:s.title}),e.jsxs("p",{className:"text-sm text-slate-500",children:["By ",s.authorId&&typeof s.authorId=="object"?`${s.authorId.firstName} ${s.authorId.lastName}`:"Unknown"," • ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${s.visibility==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:s.visibility})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm mb-6 bg-slate-50 dark:bg-slate-950 p-4 rounded-lg",children:s.summary}),e.jsxs("div",{className:"flex gap-3 justify-end border-t border-slate-100 dark:border-slate-800 pt-4",children:[e.jsx("button",{onClick:()=>ns(s),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors text-sm",children:"Preview Content"}),e.jsx("button",{onClick:()=>pe({isOpen:!0,postId:s._id}),disabled:c[s._id],className:"px-4 py-2 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-lg font-bold hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors text-sm",children:"Reject"}),e.jsxs("button",{onClick:()=>is(s._id),disabled:c[s._id],className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-bold hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-600/20 text-sm flex items-center gap-2",children:[c[s._id]?e.jsx(p,{className:"animate-spin",size:16}):e.jsx(Le,{size:16})," Approve"]})]})]},s._id))})]}),m==="users"&&(t==null?void 0:t.role)==="admin"&&e.jsx("div",{className:"space-y-6",children:I?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>je(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(us,{size:20,className:"text-slate-500"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[I.firstName," ",I.lastName]}),e.jsxs("div",{className:"flex gap-2 text-sm text-slate-500",children:[e.jsx("span",{children:I.email}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:I.role})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("h3",{className:"font-bold text-slate-500 uppercase text-xs mb-2",children:"Public Posts"}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:se.public.length})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("h3",{className:"font-bold text-slate-500 uppercase text-xs mb-2",children:"Pending Review"}),e.jsx("div",{className:"text-3xl font-bold text-yellow-600 dark:text-yellow-500",children:se.pending.length})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsx("h3",{className:"font-bold text-slate-500 uppercase text-xs mb-2",children:"Rejected"}),e.jsx("div",{className:"text-3xl font-bold text-red-600 dark:text-red-500",children:se.rejected.length})]})]}),se.public.length>0&&e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 font-bold border-b border-slate-200 dark:border-slate-800",children:"Recent Public Posts"}),e.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:se.public.map(s=>e.jsxs("button",{onClick:()=>ns(s),className:"w-full text-left p-4 hover:bg-slate-50 dark:hover:bg-slate-800/30 flex justify-between items-center group",children:[e.jsx("span",{className:"font-medium text-slate-900 dark:text-white group-hover:text-accent-600 transition-colors",children:s.title}),e.jsx("span",{className:"text-xs text-slate-500",children:new Date(s.createdAt).toLocaleDateString()})]},s._id))})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"User Management"}),e.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 text-xs uppercase font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"User"}),e.jsx("th",{className:"px-6 py-4",children:"Role"}),e.jsx("th",{className:"px-6 py-4",children:"Joined"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-800",children:Ve?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-8 text-center",children:e.jsx(p,{className:"animate-spin mx-auto"})})}):N.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-bold text-slate-900 dark:text-white",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-xs text-slate-500",children:s.email})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("select",{value:s.role||"user",onChange:a=>Xs(s._id,a.target.value),disabled:c[`role-${s._id}`],className:"bg-slate-100 dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded px-2 py-1 text-xs font-bold uppercase text-slate-900 dark:text-slate-300 outline-none focus:ring-2 focus:ring-accent-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"moderator",children:"Moderator"}),e.jsx("option",{value:"admin",children:"Admin"})]}),c[`role-${s._id}`]&&e.jsx(p,{className:"animate-spin inline ml-2",size:12})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>Ae(s),className:"text-accent-600 hover:underline text-sm font-medium",children:"Inspect"})})]},s._id))})]})})]})}),m==="admin_verifications"&&(t==null?void 0:t.role)==="admin"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"ID Verification Requests"}),Ye?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-600"})}):es.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500 bg-white dark:bg-slate-900 rounded-xl border border-dashed border-slate-200 dark:border-slate-800",children:"No pending identity checks."}):e.jsx("div",{className:"space-y-4",children:es.map((s,a)=>{var r;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center font-bold",children:(r=s.userEmail)==null?void 0:r[0].toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:s.userEmail}),e.jsxs("p",{className:"text-xs text-slate-500",children:["User ID: ",s.userId||s._id]})]})]}),e.jsxs("button",{onClick:()=>Hs(s),disabled:c[`view-${s.userId||s._id}`],className:"px-4 py-2 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 font-medium transition-colors flex items-center gap-2",children:[c[`view-${s.userId||s._id}`]?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(Ps,{size:16}),"Review Doc"]})]},a)})})]}),m==="admin_profiles"&&(t==null?void 0:t.role)==="admin"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Profile Change Reviews"}),Ve?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-600"})}):N.filter(s=>{var a,r;return((a=s.profileVerification)==null?void 0:a.requiresReview)&&((r=s.profileVerification)==null?void 0:r.status)==="pending"}).length===0?e.jsx("div",{className:"text-center py-12 text-slate-500 bg-white dark:bg-slate-900 rounded-xl border border-dashed border-slate-200 dark:border-slate-800",children:"No pending profile reviews."}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:N.filter(s=>{var a,r;return((a=s.profileVerification)==null?void 0:a.requiresReview)&&((r=s.profileVerification)==null?void 0:r.status)==="pending"}).map(s=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-xl text-slate-500 overflow-hidden",children:s.profilePic?e.jsx("img",{src:s.profilePic,className:"w-full h-full object-cover"}):s.firstName[0]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:[s.firstName," ",s.lastName]}),e.jsx("div",{className:"text-sm text-slate-500",children:s.email})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>we({isOpen:!0,userId:s._id||null}),disabled:c[`prof_${s._id}`],className:"px-4 py-2 bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 rounded-lg font-bold hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:"Reject"}),e.jsxs("button",{onClick:()=>s._id&&ds(s._id,"verified"),disabled:c[`prof_${s._id}`],className:"px-4 py-2 bg-emerald-600 text-white rounded-lg font-bold hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-600/20 flex items-center gap-2",children:[c[`prof_${s._id}`]?e.jsx(p,{size:16,className:"animate-spin"}):e.jsx(Le,{size:16})," Approve"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 bg-slate-50 dark:bg-slate-950 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-500 block",children:"Username"})," ",e.jsx("span",{className:"font-medium dark:text-slate-200",children:s.username||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-500 block",children:"Phone"})," ",e.jsx("span",{className:"font-medium dark:text-slate-200",children:s.phoneNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-500 block",children:"Passport ID"})," ",e.jsx("span",{className:"font-medium dark:text-slate-200",children:s.passportId||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-500 block",children:"Address"})," ",e.jsx("span",{className:"font-medium dark:text-slate-200",children:s.address||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-slate-500 block",children:"Location"})," ",e.jsxs("span",{className:"font-medium dark:text-slate-200",children:[s.city||"-",", ",s.country||"-"]})]})]})]},s._id))})]}),m==="liked"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Liked Posts"}),X?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-600"})}):_.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500 bg-white dark:bg-slate-900 rounded-xl border border-dashed border-slate-200 dark:border-slate-800",children:"You haven't liked any posts yet."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:_.map(s=>e.jsxs(ue,{to:`/blog/${s.slug}`,className:"group bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"h-48 overflow-hidden relative",children:[s.coverImageUrl?e.jsx("img",{src:s.coverImageUrl,alt:s.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400",children:e.jsx(Re,{size:48})}),e.jsx("div",{className:"absolute top-2 right-2 bg-white/90 dark:bg-black/80 backdrop-blur px-2 py-1 rounded text-xs font-bold shadow-sm",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white mb-2 line-clamp-1 group-hover:text-accent-600 dark:group-hover:text-accent-400 transition-colors",children:s.title}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 line-clamp-2",children:s.summary})]})]},s._id))})]})]})]})]}):null};export{Wt as default};
