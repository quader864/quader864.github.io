import{w as m}from"./index-CJHeb8qJ.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$=m("users",w),o="https://api.quader864.ir/auth/verify",n=()=>({"Content-Type":"application/json",Accept:"application/json"}),a=async e=>{const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const r=await e.json();if(!e.ok)throw new Error(r.message||`API Error: ${e.status}`);return r}else{const r=await e.text();throw console.error(`Non-JSON response from ${e.url}:`,r.substring(0,100)),new Error(`API Error: ${e.status} (Invalid Response Format)`)}},g=e=>{var s,l,u,h,p,y,f;const t=e.verification||e;if(!t||typeof t!="object")return{status:"UNVERIFIED",emailVerified:!1,identityVerified:!1,identityStatus:"unverified"};let r="unverified";return(s=t.identity)!=null&&s.verified?r="verified":t.rejectionReason?r="rejected":((l=t.identity)!=null&&l.documentKey||(u=t.identity)!=null&&u.documentUrl)&&(r="pending"),{status:t.overall||"UNVERIFIED",emailVerified:!!((h=t.email)!=null&&h.verified),identityVerified:!!((p=t.identity)!=null&&p.verified),identityStatus:r,rejectionReason:t.rejectionReason,updatedAt:((y=t.identity)==null?void 0:y.verifiedAt)||((f=t.email)==null?void 0:f.verifiedAt)}},P={getStatus:async()=>{try{const e=await fetch(`${o}/status`,{method:"GET",headers:n(),mode:"cors",credentials:"include"}),t=await a(e);return g(t)}catch(e){throw console.error("Fetch status failed:",e),e}},sendEmailOtp:async()=>{try{const e=await fetch(`${o}/email/send-otp`,{method:"POST",headers:n(),mode:"cors",credentials:"include",body:JSON.stringify({})});return await a(e)}catch(e){throw new Error(e.message||"Failed to send OTP")}},confirmEmailOtp:async e=>{try{const t=await fetch(`${o}/email/confirm-otp`,{method:"POST",headers:n(),mode:"cors",credentials:"include",body:JSON.stringify({otp:e})});return await a(t)}catch(t){throw new Error(t.message||"Invalid OTP")}},uploadIdentity:async e=>{const t=new FormData;t.append("document",e);try{const r=await fetch(`${o}/identity/upload`,{method:"POST",headers:{Accept:"application/json"},mode:"cors",credentials:"include",body:t});return await a(r)}catch(r){throw new Error(r.message||"Upload failed")}},getPendingRequests:async()=>{try{const e=`${o}/identity/pending`,t=await fetch(e,{method:"GET",headers:n(),mode:"cors",credentials:"include"});return await a(t)}catch(e){return console.error("[VerificationAPI] Fetch pending failed:",e),[]}},getPresignedUrl:async e=>{try{const t=await fetch(`${o}/identity/${e}/presign`,{method:"GET",headers:n(),mode:"cors",credentials:"include"});return{url:(await a(t)).presignedUrl}}catch(t){throw new Error(t.message||"Failed to get document URL")}},approveIdentity:async e=>{try{const t=await fetch(`${o}/identity/${e}/approve`,{method:"POST",headers:n(),mode:"cors",credentials:"include",body:JSON.stringify({})});return await a(t)}catch(t){throw new Error(t.message||"Action failed")}},rejectIdentity:async(e,t)=>{try{const r=await fetch(`${o}/identity/${e}/reject`,{method:"POST",headers:n(),mode:"cors",credentials:"include",body:JSON.stringify({reason:t})});return await a(r)}catch(r){throw new Error(r.message||"Action failed")}}},i="https://api.quader864.ir/api/users",d=()=>({"Content-Type":"application/json",Accept:"application/json"}),c=async e=>{const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const r=await e.json();if(!e.ok)throw new Error(r.message||r.error||`API Error: ${e.status}`);return r}else{const r=await e.text();throw console.error(`Non-JSON response from ${e.url}:`,r.substring(0,100)),new Error(`API Error: ${e.status} (Invalid Response Format)`)}},j={getAll:async()=>{try{const e=await fetch(`${i}`,{method:"GET",headers:d(),mode:"cors",credentials:"include"});return await c(e)}catch(e){return console.error("Fetch users failed:",e),[]}},updateRole:async(e,t)=>{try{const r=await fetch(`${i}/${e}/role`,{method:"PATCH",headers:d(),mode:"cors",credentials:"include",body:JSON.stringify({role:t})});return await c(r),{success:!0,message:"User role updated successfully"}}catch(r){return{success:!1,message:r.message}}},uploadProfilePic:async e=>{const t=new FormData;t.append("profilePic",e);try{const r=await fetch(`${i}/upload/profile-pic`,{method:"POST",headers:{Accept:"application/json"},mode:"cors",credentials:"include",body:t});return await c(r)}catch(r){throw new Error(r.message||"Image upload failed")}},updateProfile:async e=>{try{const t=await fetch(`${i}/me/profile`,{method:"PATCH",headers:d(),mode:"cors",credentials:"include",body:JSON.stringify(e)});return await c(t)}catch(t){throw new Error(t.message||"Profile update failed")}},verifyProfile:async(e,t,r)=>{try{const s=await fetch(`${i}/${e}/profile-verification`,{method:"PATCH",headers:d(),mode:"cors",credentials:"include",body:JSON.stringify({status:t,rejectionReason:r})});return await c(s)}catch(s){throw new Error(s.message||"Verification update failed")}}};export{$ as U,j as u,P as v};
