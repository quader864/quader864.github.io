import{w as m}from"./index-CSbus0M7.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],E=m("users",w),n="https://api.quader864.ir/auth/verify",o=()=>({"Content-Type":"application/json",Accept:"application/json"}),s=async e=>{const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const r=await e.json();if(!e.ok)throw new Error(r.message||`API Error: ${e.status}`);return r}else{const r=await e.text();throw console.error(`Non-JSON response from ${e.url}:`,r.substring(0,100)),new Error(`API Error: ${e.status} (Invalid Response Format)`)}},g=e=>{var a,i,c,d,l,u,y;const t=e.verification||e;if(!t||typeof t!="object")return{status:"UNVERIFIED",emailVerified:!1,identityVerified:!1,identityStatus:"unverified"};let r="unverified";return(a=t.identity)!=null&&a.verified?r="verified":t.rejectionReason?r="rejected":((i=t.identity)!=null&&i.documentKey||(c=t.identity)!=null&&c.documentUrl)&&(r="pending"),{status:t.overall||"UNVERIFIED",emailVerified:!!((d=t.email)!=null&&d.verified),identityVerified:!!((l=t.identity)!=null&&l.verified),identityStatus:r,rejectionReason:t.rejectionReason,updatedAt:((u=t.identity)==null?void 0:u.verifiedAt)||((y=t.email)==null?void 0:y.verifiedAt)}},$={getStatus:async()=>{try{const e=await fetch(`${n}/status`,{method:"GET",headers:o(),mode:"cors",credentials:"include"}),t=await s(e);return g(t)}catch(e){throw console.error("Fetch status failed:",e),e}},sendEmailOtp:async()=>{try{const e=await fetch(`${n}/email/send-otp`,{method:"POST",headers:o(),mode:"cors",credentials:"include",body:JSON.stringify({})});return await s(e)}catch(e){throw new Error(e.message||"Failed to send OTP")}},confirmEmailOtp:async e=>{try{const t=await fetch(`${n}/email/confirm-otp`,{method:"POST",headers:o(),mode:"cors",credentials:"include",body:JSON.stringify({otp:e})});return await s(t)}catch(t){throw new Error(t.message||"Invalid OTP")}},uploadIdentity:async e=>{const t=new FormData;t.append("document",e);try{const r=await fetch(`${n}/identity/upload`,{method:"POST",headers:{Accept:"application/json"},mode:"cors",credentials:"include",body:t});return await s(r)}catch(r){throw new Error(r.message||"Upload failed")}},getPendingRequests:async()=>{try{const e=`${n}/identity/pending`,t=await fetch(e,{method:"GET",headers:o(),mode:"cors",credentials:"include"});return await s(t)}catch(e){return console.error("[VerificationAPI] Fetch pending failed:",e),[]}},getPresignedUrl:async e=>{try{const t=await fetch(`${n}/identity/${e}/presign`,{method:"GET",headers:o(),mode:"cors",credentials:"include"});return{url:(await s(t)).presignedUrl}}catch(t){throw new Error(t.message||"Failed to get document URL")}},approveIdentity:async e=>{try{const t=await fetch(`${n}/identity/${e}/approve`,{method:"POST",headers:o(),mode:"cors",credentials:"include",body:JSON.stringify({})});return await s(t)}catch(t){throw new Error(t.message||"Action failed")}},rejectIdentity:async(e,t)=>{try{const r=await fetch(`${n}/identity/${e}/reject`,{method:"POST",headers:o(),mode:"cors",credentials:"include",body:JSON.stringify({reason:t})});return await s(r)}catch(r){throw new Error(r.message||"Action failed")}}},h="https://api.quader864.ir/api/users",p=()=>({"Content-Type":"application/json",Accept:"application/json"}),f=async e=>{const t=e.headers.get("content-type");if(t&&t.includes("application/json")){const r=await e.json();if(!e.ok)throw new Error(r.message||`API Error: ${e.status}`);return r}else{const r=await e.text();throw console.error(`Non-JSON response from ${e.url}:`,r.substring(0,100)),new Error(`API Error: ${e.status} (Invalid Response Format)`)}},v={getAll:async()=>{try{const e=await fetch(`${h}`,{method:"GET",headers:p(),mode:"cors",credentials:"include"});return await f(e)}catch(e){return console.error("Fetch users failed:",e),[]}},updateRole:async(e,t)=>{try{const r=await fetch(`${h}/${e}/role`,{method:"PATCH",headers:p(),mode:"cors",credentials:"include",body:JSON.stringify({role:t})});return await f(r),{success:!0,message:"User role updated successfully"}}catch(r){return{success:!1,message:r.message}}}};export{E as U,v as u,$ as v};
